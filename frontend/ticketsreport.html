<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>ITINFRA TICKETS | Aditya Educational Institutions</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
<!--<script src="./excellentexport.js"></script>-->
<script type="text/javascript">
var app = angular.module("itinfra", []);
app.filter('sumByColumn', function() {
    return function(data, key) {
      if (angular.isUndefined(data) || angular.isUndefined(key))
        return 0;
      var sum = 0;

      angular.forEach(data, function(v, k) {
        sum = sum + parseInt(v[key]);
      });
      return sum;
    }
  })
app.controller('report', function($scope, $http, $filter) {
	//alert('test')
	 //var monthpaycode = '07-2023/2142008';

 
    //let apipath = 'http://10.70.3.229:3002/api/'; 
    //let apipath = 'http://10.60.1.9:3002/api/';
    let apipath = 'https://apis.aditya.ac.in/itinfra/';
    
    $scope.todate = new Date()     
    $scope.SystemsWorkingStatus = (inst)=>{
         $http.get(apipath+"TicketMaster/SystemsWorkingStatus?instname=%22"+inst+"%22").success(function(data){
            //console.log(data);
             let filterdata = data.filter(e=>e.campusName!='ADPGMSC' && e.campusName!='AIPGS')
             for(let i=0; i<filterdata.length; i++){
                 filterdata[i].notworking = filterdata[i].activetickets - filterdata[i].completed
             }
             $scope.systemscountlist = filterdata;
         });	
  
     }
	
});
</script>

</head>

<body ng-app="itinfra" ng-controller="report">
	<div class="container" ng-init="SystemsWorkingStatus('DEGREE COLLEGE')">
        <table class="table table-striped table-bordered" ng-show="systemscountlist.length>0">
            <thead>
                <tr>
                    <td colspan="8">
                        <h4>TICKETS REPORT ON {{todate | date}}</h4>
                    </td>
                </tr>
                <tr>
                    <th>S.NO</th>
                    <th>CAMPUS</th>
                    <th>TOTAL</th>
                    <th class="text-center">TICKET RAISED BY LAB INCHARGE</th>
                    <th class="text-center">COMPLETED BY HARDWARE</th>
                    <th class="text-center">NOT CLOSED BY LAB INCHARGE</th>
                    <th>NAME</th>
                    <th>PHONE NO.</th>
                </tr>	
            </thead>
            <tbody>
                <tr ng-repeat="x in systemscountlist">
                    <td>{{$index+1}}</td>
                    <td>{{x.campusName}}</td>
                    <td class="text-right">{{x.total}}</td>
                    <td class="text-right">{{x.notworking}}</td>
                    <td class="text-right">{{x.completed}}</td>
                    <td class="text-right">{{x.activetickets}}</td>
                    <td class="text-uppercase">{{x.userName}}</td>
                    <td>{{x.userPhone}}</td>
                </tr>	
            </tbody>
            <tfoot>
                <tr>
                    <th colspan="2" align="right">TOTAL</th>
                    <th class="text-right">{{ systemscountlist | sumByColumn: 'total' }}</th>
                    <th class="text-right">{{ systemscountlist | sumByColumn: 'notworking' }}</th>
                    <th class="text-right">{{ systemscountlist | sumByColumn: 'completed' }}</th>
                    <th class="text-right">{{ systemscountlist | sumByColumn: 'activetickets' }}</th>
                    
                </tr>
            </tfoot>
        </table>
    </div>



	 
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</body>
</html>
